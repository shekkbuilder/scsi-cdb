/*! scsi-cdb 2015-11-02 */
"use strict";function getField(a,b,c,d){var e=8*c+d,f=e+b-1,g=parseInt(f/8);if((f+1)%8>0&&g++,g<a.length){for(var h=bigInt(),i=0,j=c,k=d,l=b;l>0;){var m,n=8-k;m=l>n?n:l;var o=(1<<m)-1,p=a[j];p>>=k,p&=o,h=h.shiftLeft(m).or(p),i+=m,l-=m,k+=m,k>7&&(k=0,j++)}return h}throw new Error("Input truncated")}var bigInt=require("big-integer"),assert=require("assert"),commands=[],backgroundControl=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"Reserved",length:3,"byte":1,bit:5,reserved:!0},{name:"Reserved",length:6,"byte":2,bit:0,reserved:!0},{name:"BO_CTL",length:2,"byte":2,bit:6},{name:"BO_TIME",length:8,"byte":3,bit:0},{name:"Reserved",length:88,"byte":4,bit:0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"BACKGROUND CONTROL",layout:backgroundControl,operationCode:158,serviceAction:21});var compareAndWrite=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Reserved",length:1,"byte":1,bit:0,reserved:!0},{name:"FUA_NV",length:1,"byte":1,bit:1},{name:"Reserved",length:1,"byte":1,bit:2,reserved:!0},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"Reserved",length:24,"byte":10,bit:0},{name:"NUMBER OF LOGICAL BLOCKS",length:8,"byte":13,bit:0},{name:"GROUP NUMBER",length:5,"byte":14,bit:0},{name:"Reserved",length:3,"byte":14,bit:5},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"COMPARE AND WRITE",layout:compareAndWrite,operationCode:137});var formatUnit=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"DEFECT LIST FORMAT",length:3,"byte":1,bit:0},{name:"CMPLIST",length:1,"byte":1,bit:3},{name:"FMTDATA",length:1,"byte":1,bit:4},{name:"LONGLIST",length:1,"byte":1,bit:5},{name:"FMTPINFO",length:2,"byte":1,bit:6},{name:"Vendor specific",length:8,"byte":2,bit:0},{name:"Obsolete",length:16,"byte":3,bit:0},{name:"CONTROL",length:8,"byte":5,bit:0}];commands.push({name:"FORMAT UNIT",layout:formatUnit,operationCode:4});var getLbaStatus=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"Reserved",length:3,"byte":1,bit:5},{name:"STARTING LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"ALLOCATION LENGTH",length:32,"byte":10,bit:0},{name:"Reserved",length:8,"byte":14,bit:0,reserved:!0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"GET LBA STATUS",layout:getLbaStatus,operationCode:158,serviceAction:18});var getStreamStatus=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"Reserved",length:3,"byte":1,bit:5,reserved:!0},{name:"Reserved",length:16,"byte":2,bit:0,reserved:!0},{name:"STARTING STREAM IDENTIFIED",length:16,"byte":4,bit:0},{name:"Reserved",length:32,"byte":6,bit:0,reserved:!0},{name:"ALLOCATION LENGTH",length:32,"byte":10,bit:0},{name:"Reserved",length:8,"byte":14,bit:0,reserved:!0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"GET STREAM STATUS",layout:getStreamStatus,operationCode:158,serviceAction:22});var orwrite16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Reserved",length:3,"byte":1,bit:0,reserved:!0},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"ORPROTECT",length:3,"byte":1,bit:5},{name:"STARTING LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":10,bit:0},{name:"GROUP NUMBER",length:5,"byte":14,bit:0},{name:"Reserved",length:3,"byte":14,bit:5,reserved:!0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"ORWRITE (16)",layout:orwrite16,operationCode:139});var orwrite32=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"CONTROL",length:8,"byte":1,bit:0},{name:"BMOP",length:3,"byte":2,bit:0},{name:"Reserved",length:5,"byte":2,bit:3,reserved:!0},{name:"PREVIOUS GENERATION PROCESSING",length:4,"byte":3,bit:0},{name:"Reserved",length:4,"byte":3,bit:4,reserved:!0},{name:"Reserved",length:16,"byte":4,bit:0,reserved:!0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"ADDITIONAL CDB LENGTH",length:8,"byte":7,bit:0},{name:"SERVICE ACTION",length:16,"byte":8,bit:0},{name:"Reserved",length:3,"byte":10,bit:0,reserved:!0},{name:"FUA",length:1,"byte":10,bit:3},{name:"DPO",length:1,"byte":10,bit:4},{name:"ORPROTECT",length:3,"byte":10,bit:5},{name:"Reserved",length:8,"byte":11,bit:0,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":12,bit:0},{name:"EXPECTED ORWGENERATION",length:32,"byte":20,bit:0},{name:"NEW ORWGENERATION",length:32,"byte":24,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":28,bit:0}];commands.push({name:"ORWRITE (32)",layout:orwrite32,operationCode:127,serviceAction:14});var populateToken=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"Reserved",length:3,"byte":1,bit:5,reserved:!0},{name:"Reserved",length:32,"byte":2,bit:0,reserved:!0},{name:"LIST IDENTIFIER",length:32,"byte":6,bit:0},{name:"PARAMETER LIST LENGTH",length:32,"byte":10,bit:0},{name:"GROUP NUMBER",length:5,"byte":14,bit:0},{name:"Reserved",length:3,"byte":14,bit:5,reserved:!0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"POPULATE TOKEN",layout:populateToken,operationCode:131,serviceAction:16});var preFetch10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"IMMED",length:1,"byte":1,bit:1},{name:"Reserved",length:6,"byte":1,bit:2},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"PREFETCH LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"PRE-FETCH (10)",layout:preFetch10,operationCode:52});var preFetch16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"IMMED",length:1,"byte":1,bit:1},{name:"Reserved",length:6,"byte":1,bit:2},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"PREFETCH LENGTH",length:32,"byte":10,bit:0},{name:"GROUP NUMBER",length:5,"byte":14,bit:0},{name:"Reserved",length:3,"byte":14,bit:0,reserved:!0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"PRE-FETCH (16)",layout:preFetch16,operationCode:144});var preventAllowMediumRemoval=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Reserved",length:8,"byte":1,bit:0,reserved:!0},{name:"Reserved",length:8,"byte":2,bit:0,reserved:!0},{name:"Reserved",length:8,"byte":3,bit:0,reserved:!0},{name:"PREVENT",length:2,"byte":4,bit:0},{name:"Reserved",length:8,"byte":4,bit:2,reserved:!0},{name:"CONTROL",length:8,"byte":5,bit:0}];commands.push({name:"PREVENT ALLOW MEDIUM REMOVAL",layout:preventAllowMediumRemoval,operationCode:30});var read10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"Obsolete",length:1,"byte":1,bit:1,obsolete:!0},{name:"RARC",length:1,"byte":1,bit:2},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"RDPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"TRANSFER LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"READ (10)",layout:read10,operationCode:40});var read12=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"Obsolete",length:1,"byte":1,bit:1,obsolete:!0},{name:"RARC",length:1,"byte":1,bit:2},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"RDPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":6,bit:0},{name:"GROUP NUMBER",length:5,"byte":10,bit:0},{name:"Reserved",length:2,"byte":10,bit:5,reserved:!0},{name:"Restricted for MMC-6",length:1,"byte":10,bit:7},{name:"CONTROL",length:8,"byte":11,bit:0}];commands.push({name:"READ (12)",layout:read12,operationCode:168});var read16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"DLD2",length:1,"byte":1,bit:0},{name:"Obsolete",length:1,"byte":1,bit:1,obsolete:!0},{name:"RARC",length:1,"byte":1,bit:2},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"RDPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":10,bit:0},{name:"GROUP NUMBER",length:6,"byte":14,bit:0},{name:"DLD0",length:1,"byte":14,bit:6},{name:"DLD1",length:1,"byte":14,bit:7},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"READ (16)",layout:read16,operationCode:136});var read32=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"CONTROL",length:8,"byte":1,bit:0},{name:"Reserved",length:32,"byte":2,bit:0,reserved:!0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"ADDITIONAL CDB LENGTH",length:8,"byte":7,bit:0},{name:"SERVICE ACTION",length:16,"byte":8,bit:0},{name:"Reserved",length:1,"byte":10,bit:0,reserved:!0},{name:"Obsolete",length:1,"byte":10,bit:1,obsolete:!0},{name:"RARC",length:1,"byte":10,bit:2},{name:"FUA",length:1,"byte":10,bit:3},{name:"DPO",length:1,"byte":10,bit:4},{name:"RDPROTECT",length:3,"byte":10,bit:5},{name:"Reserved",length:8,"byte":11,bit:0,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":12,bit:0},{name:"EXPECTED INITIAL LOGICAL BLOCK REFERENCE TAG",length:32,"byte":20,bit:0},{name:"EXPECTED LOGICAL BLOCK APPLICATION TAG",length:16,"byte":24,bit:0},{name:"LOGICAL BLOCK APPLICATION TAG MASK",length:16,"byte":26,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":28,bit:0}];commands.push({name:"READ (32)",layout:read32,operationCode:127,serviceAction:9});var readCapacity10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"Reserved",length:7,"byte":1,bit:1,reserved:!0},{name:"Obsolete",length:32,"byte":2,bit:0,obsolete:!0},{name:"Reserved",length:16,"byte":6,bit:0,reserved:!0},{name:"Obsolete",length:1,"byte":8,bit:0,obsolete:!0},{name:"Reserved",length:7,"byte":8,bit:1,reserved:!0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"READ CAPACITY (10)",layout:readCapacity10,operationCode:37});var readCapacity16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"Reserved",length:1,"byte":1,bit:5,reserved:!0},{name:"Obsolete",length:64,"byte":2,bit:0,obsolete:!0},{name:"ALLOCATION LENGTH",length:32,"byte":10,bit:0},{name:"Obsolete",length:1,"byte":14,bit:0,obsolete:!0},{name:"Reserved",length:7,"byte":14,bit:1,reserved:!0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"READ CAPACITY (16)",layout:readCapacity16,operationCode:158,serviceAction:16});var readDefectData10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Reserved",length:8,"byte":1,bit:0,reserved:!0},{name:"DEFECT LIST_FORMAT",length:3,"byte":2,bit:0},{name:"REQ_GLIST",length:1,"byte":2,bit:3},{name:"REQ_PLIST",length:1,"byte":2,bit:4},{name:"Reserved",length:3,"byte":2,bit:5},{name:"Reserved",length:32,"byte":3,bit:0,reserved:!0},{name:"ALLOCATION LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"READ DEFECT DATA (10)",layout:readDefectData10,operationCode:55});var readDefectData12=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"DEFECT LIST FORMAT",length:3,"byte":1,bit:0},{name:"REQ_GLIST",length:1,"byte":1,bit:3},{name:"REQ_PLIST",length:1,"byte":1,bit:4},{name:"Reserved",length:3,"byte":1,bit:5,reserved:!0},{name:"ADDRESS DESCRIPTOR INDEX",length:32,"byte":2,bit:0},{name:"ALLOCATION LENGTH",length:32,"byte":6,bit:0},{name:"Reserved",length:8,"byte":10,bit:0,reserved:!0},{name:"CONTROL",length:8,"byte":11,bit:0}];commands.push({name:"READ DEFECT DATA (12)",layout:readCapacity16,operationCode:183});var readLong10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"CORRCT",length:1,"byte":1,bit:1},{name:"PBLOCK",length:1,"byte":1,bit:2},{name:"Reserved",length:5,"byte":1,bit:3,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"Reserved",length:8,"byte":6,bit:0,reserved:!0},{name:"BYTE TRANSFER LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,bytes:9,bit:0}];commands.push({name:"READ LONG (10)",layout:readLong10,operationCode:62});var readLong16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"Reserved",length:3,"byte":1,bit:5,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"Reserved",length:16,"byte":10,bit:0,reserved:!0},{name:"BYTE TRANSFER LENGTH","byte":12,bit:0},{name:"CORRCT",length:1,"byte":14,bit:0},{name:"PBLOCK",length:1,"byte":14,bit:1},{name:"Reserved",length:6,"byte":14,bit:2},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"READ LONG (16)",layout:readLong16,operationCode:158,serviceAction:17});var reassignBlocks=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"LONGLIST",length:1,"byte":1,bit:0},{name:"LONGLBA",length:1,"byte":1,bit:1},{name:"Reserved",length:6,"byte":1,bit:2,reserved:!0},{name:"Reserved",length:32,"byte":2,bit:0,reserved:!0},{name:"CONTROL",length:8,"byte":5,bit:0}];commands.push({name:"REASSIGN BLOCKS",layout:reassignBlocks,operationCode:7});var reportReferrals=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"Reserved",length:3,"byte":1,bit:5,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"ALLOCATION LENGTH",length:32,"byte":10,bit:0},{name:"ONE_SEG",length:1,"byte":14,bit:0},{name:"Reserved",length:7,"byte":14,bit:1},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"REPORT REFERRALS",layout:reportReferrals,operationCode:158,serviceAction:19});var sanitize=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"AUSE",length:1,"byte":1,bit:5},{name:"Reserved",length:1,"byte":1,bit:6},{name:"IMMED",length:1,"byte":1,bit:7},{name:"Reserved",length:40,"byte":2,bit:0,reserved:!0},{name:"PARAMETER LIST LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"SANITIZE",layout:sanitize,operationCode:72});var startStopUnit=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"IMMED",length:1,"byte":1,bit:0},{name:"Reserved",length:7,"byte":1,bit:1},{name:"Reserved",length:8,"byte":2,bit:0},{name:"POWER CONDITION MODIFIER",length:4,"byte":3,bit:0},{name:"Reserved",length:4,"byte":4,bit:4},{name:"CONTROL",length:8,"byte":5,bit:0}];commands.push({name:"START STOP UNIT",layout:startStopUnit,operationCode:27});var streamControl=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"STR_CTL",length:2,"byte":1,bit:5},{name:"Reserved",length:1,"byte":1,bit:7,reserved:!0},{name:"Reserved",length:16,"byte":2,bit:0,reserved:!0},{name:"STR_ID",length:16,"byte":4,bit:0},{name:"Reserved",length:72,"byte":6,bit:0,reserved:!0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"STREAM CONTROL",layout:streamControl,operationCode:158,serviceAction:20});var synchronizeCache10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"IMMED",length:1,"byte":1,bit:1},{name:"Obsolete",length:1,"byte":1,bit:2,obsolete:!0},{name:"Reserved",length:5,"byte":1,bit:3,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5},{name:"NUMBER OF LOGICAL BLOCKS",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"SYNCHRONIZE CACHE (10)",layout:synchronizeCache10,operationCode:53});var synchronizeCache16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Reserved",length:1,"byte":1,bit:0,reserved:!0},{name:"IMMED",length:1,"byte":1,bit:1},{name:"Obsolete",length:1,"byte":1,bit:2,obsolete:!0},{name:"Reserved",length:5,"byte":1,bit:3,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"NUMBER OF LOGICAL BLOCKS",length:32,"byte":10,bit:0},{name:"GROUP NUMBER",length:5,"byte":14,bit:0},{name:"Reserved",length:3,"byte":14,bit:5},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"SYNCHRONIZE CACHE (16)",layout:synchronizeCache16,operationCode:145});var unmap=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"ANCHOR",length:1,"byte":1,bit:0},{name:"Reserved",length:7,"byte":1,bit:1,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5},{name:"PARAMETER LIST LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"UNMAP",layout:unmap,operationCode:66});var verify10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"BYTCHK",length:2,"byte":1,bit:1},{name:"Reserved",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"VRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:2,"byte":6,bit:5,reserved:!0},{name:"Restricted for MMC-6",length:1,"byte":6,bit:7,reserved:!0},{name:"VERIFICATION LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"VERIFY (10)",layout:verify10,operationCode:47});var verify12=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"BYTCHK",length:2,"byte":1,bit:1},{name:"Reserved",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"VRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"VERIFICATION LENGTH",length:32,"byte":6,bit:0},{name:"GROUP NUMBER",length:5,"byte":10,bit:0},{name:"Reserved",length:2,"byte":10,bit:5,reserved:!0},{name:"Restricted for MMC-6",length:1,"byte":10,bit:7},{name:"CONTROL",length:8,"byte":11,bit:0}];commands.push({name:"VERIFY (12)",layout:verify12,operationCode:175});var verify16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Reserved",length:1,"byte":1,bit:0,reserved:!0},{name:"BYTCHK",length:2,"byte":1,bit:1},{name:"Reserved",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"VRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"VERIFICATION LENGTH",length:32,"byte":10,bit:0},{name:"GROUP NUMBER",length:5,"byte":14,bit:0},{name:"Reserved",length:2,"byte":14,bit:5,reserved:!0},{name:"Restricted for MMC-6",length:1,"byte":14,bit:7},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"VERIFY (16)",layout:verify16,operationCode:143});var verify32=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"CONTROL",length:8,"byte":1,bit:0},{name:"Reserved",length:32,"byte":2,bit:0,reserved:!0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"ADDITIONAL CDB LENGTH",length:8,"byte":7,bit:0},{name:"SERVICE ACTION",length:16,"byte":8,bit:0},{name:"Reserved",length:1,"byte":10,bit:0,reserved:!0},{name:"BYTCHK",length:2,"byte":10,bit:1},{name:"Reserved",length:1,"byte":10,bit:2,reserved:!0},{name:"DPO",length:1,"byte":10,bit:4},{name:"VRPROTECT",length:3,"byte":10,bit:5},{name:"Reserved",length:8,"byte":11,bit:0,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":12,bit:0},{name:"EXPECTED INITIAL LOGICAL BLOCK REFERENCE TAG",length:32,"byte":20,bit:0},{name:"EXPECTED LOGICAL BLOCK APPLICATION TAG",length:16,"byte":24,bit:0},{name:"LOGICAL BLOCK APPLICATION TAG MASK",length:16,"byte":26,bit:0},{name:"VERIFICATION LENGTH",length:32,"byte":28,bit:0}];commands.push({name:"VERIFY (32)",layout:verify32,operationCode:127,serviceAction:10});var write10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"Obsolete",length:1,"byte":1,bit:1,obsolete:!0},{name:"Reserved",length:1,"byte":1,bit:2,reserved:!0},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"TRANSFER LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"WRITE (10)",layout:write10,operationCode:42});var write12=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"Obsolete",length:1,"byte":1,bit:1,obsolete:!0},{name:"Reserved",length:1,"byte":1,bit:2,reserved:!0},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":6,bit:0},{name:"GROUP NUMBER",length:5,"byte":10,bit:0},{name:"Reserved",length:2,"byte":10,bit:5,reserved:!0},{name:"Restricted for MMC-6",length:1,"byte":10,bit:7},{name:"CONTROL",length:8,"byte":11,bit:0}];commands.push({name:"WRITE (12)",layout:write12,operationCode:170});var write16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Reserved",length:1,"byte":1,bit:0,reserved:!0},{name:"Obsolete",length:1,"byte":1,bit:1,obsolete:!0},{name:"Reserved",length:1,"byte":1,bit:2,reserved:!0},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":10,bit:0},{name:"GROUP NUMBER",length:5,"byte":14,bit:0},{name:"Reserved",length:2,"byte":14,bit:5,reserved:!0},{name:"Restricted for MMC-6",length:1,"byte":14,bit:7},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"WRITE (16)",layout:write16,operationCode:138});var write32=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"CONTROL",length:8,"byte":1,bit:0},{name:"Reserved",length:32,"byte":2,bit:0,reserved:!0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"ADDITIONAL CDB LENGTH",length:8,"byte":7,bit:0},{name:"SERVICE ACTION",length:16,"byte":8,bit:0},{name:"Reserved",length:1,"byte":10,bit:0,reserved:!0},{name:"Obsolete",length:1,"byte":10,bit:1,obsolete:!0},{name:"Reserved",length:1,"byte":10,bit:2,reserved:!0},{name:"FUA",length:1,"byte":10,bit:3},{name:"DPO",length:1,"byte":10,bit:4},{name:"WRPROTECT",length:3,"byte":10,bit:5},{name:"Reserved",length:8,"byte":11,bit:0,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":12,bit:0},{name:"EXPECTED INITIAL LOGICAL BLOCK REFERENCE TAG",length:32,"byte":20,bit:0},{name:"EXPECTED LOGICAL BLOCK APPLICATION TAG",length:16,"byte":24,bit:0},{name:"LOGICAL BLOCK APPLICATION TAG MASK",length:16,"byte":26,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":28,bit:0}];commands.push({name:"WRITE (32)",layout:write32,operationCode:127,serviceAction:11});var writeAndVerify10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"BYTCHK",length:2,"byte":1,bit:1},{name:"Reserved",length:1,"byte":1,bit:3,reserved:!0},{name:"DPO",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"TRANSFER LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"WRITE AND VERIFY (10)",layout:writeAndVerify10,operationCode:46});var writeAndVerify12=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"BYTCHK",length:2,"byte":1,bit:1},{name:"Reserved",length:1,"byte":1,bit:3,reserved:!0},{name:"DPO",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":6,bit:0},{name:"GROUP NUMBER",length:5,"byte":10,bit:0},{name:"Reserved",length:2,"byte":10,bit:5,reserved:!0},{name:"Restricted for MMC-6",length:1,"byte":10,bit:7},{name:"CONTROL",length:8,"byte":11,bit:0}];commands.push({name:"WRITE AND VERIFY (12)",layout:writeAndVerify12,operationCode:174});var writeAndVerify16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Reserved",length:1,"byte":1,bit:0,reserved:!0},{name:"BYTCHK",length:2,"byte":1,bit:1},{name:"Reserved",length:1,"byte":1,bit:3,reserved:!0},{name:"DPO",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":10,bit:0},{name:"GROUP NUMBER",length:5,"byte":14,bit:0},{name:"Reserved",length:2,"byte":14,bit:5,reserved:!0},{name:"Restricted for MMC-6",length:1,"byte":14,bit:7},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"WRITE AND VERIFY (16)",layout:writeAndVerify16,operationCode:142});var writeAndVerify32=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"CONTROL",length:8,"byte":1,bit:0},{name:"Reserved",length:32,"byte":2,bit:0,reserved:!0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"ADDITIONAL CDB LENGTH",length:8,"byte":7,bit:0},{name:"SERVICE ACTION",length:16,"byte":8,bit:0},{name:"Reserved",length:1,"byte":10,bit:0,reserved:!0},{name:"BYTCHK",length:2,"byte":10,bit:1,obsolete:!0},{name:"Reserved",length:1,"byte":10,bit:3,reserved:!0},{name:"DPO",length:1,"byte":10,bit:4},{name:"WRPROTECT",length:3,"byte":10,bit:5},{name:"Reserved",length:8,"byte":11,bit:0,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":12,bit:0},{name:"EXPECTED INITIAL LOGICAL BLOCK REFERENCE TAG",length:32,"byte":20,bit:0},{name:"EXPECTED LOGICAL BLOCK APPLICATION TAG",length:16,"byte":24,bit:0},{name:"LOGICAL BLOCK APPLICATION TAG MASK",length:16,"byte":26,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":28,bit:0}];commands.push({name:"WRITE AND VERIFY (32)",layout:writeAndVerify32,operationCode:127,serviceAction:12});var writeAtomic16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Reserved",length:3,"byte":1,bit:0},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"ATOMIC BOUNDARY",length:16,"byte":10,bit:0},{name:"TRANSFER LENGTH",length:16,"byte":12,bit:0},{name:"GROUP NUMBER",length:6,"byte":14,bit:0},{name:"Reserved",length:2,"byte":14,bit:6},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"WRITE ATOMIC (16)",layout:writeAtomic16,operationCode:156});var writeAtomic32=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"CONTROL",length:8,"byte":1,bit:0},{name:"Reserved",length:16,"byte":2,bit:0,reserved:!0},{name:"ATOMIC BOUNDARY",length:16,"byte":4,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"ADDITIONAL CDB LENGTH",length:8,"byte":7,bit:0},{name:"SERVICE ACTION",length:16,"byte":8,bit:0},{name:"Reserved",length:1,"byte":10,bit:0,reserved:!0},{name:"Obsolete",length:1,"byte":10,bit:1,obsolete:!0},{name:"Reserved",length:1,"byte":10,bit:2,reserved:!0},{name:"FUA",length:1,"byte":10,bit:3},{name:"DPO",length:1,"byte":10,bit:4},{name:"WRPROTECT",length:3,"byte":10,bit:5},{name:"Reserved",length:8,"byte":11,bit:0,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":12,bit:0},{name:"EXPECTED INITIAL LOGICAL BLOCK REFERENCE TAG",length:32,"byte":20,bit:0},{name:"EXPECTED LOGICAL BLOCK APPLICATION TAG",length:16,"byte":24,bit:0},{name:"LOGICAL BLOCK APPLICATION TAG MASK",length:16,"byte":26,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":28,bit:0}];commands.push({name:"WRITE ATOMIC (32)",layout:writeAtomic32,operationCode:127,serviceAction:15});var writeLong10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:1,"byte":1,bit:0,obsolete:!0},{name:"Reserved",length:4,"byte":1,bit:1,reserved:!0},{name:"PBLOCK",length:1,"byte":1,bit:5},{name:"WR_UNCOR",length:1,"byte":1,bit:6},{name:"COR_DIS",length:1,"byte":1,bit:7},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"Reserved",length:8,"byte":6,bit:0,reserved:!0},{name:"BYTE TRANSFER LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"WRITE LONG (10)",layout:writeLong10,operationCode:63});var writeLong16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"PBLOCK",length:1,"byte":1,bit:5},{name:"WR_UNCOR",length:1,"byte":1,bit:6},{name:"COR_DIS",length:1,"byte":1,bit:7},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"Reserved",length:16,"byte":10,bit:0,reserved:!0},{name:"BYTE TRANSFER LENGTH",length:16,"byte":12,bit:0},{name:"Reserved",length:16,"byte":14,bit:0,reserved:!0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"WRITE LONG (16)",layout:writeLong16,operationCode:159,serviceAction:17});var writeSame10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Obsolete",length:3,"byte":1,bit:0,obsolete:!0},{name:"UNMAP",length:1,"byte":1,bit:3},{name:"ANCHOR",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"NUMBER OF LOGICAL BLOCKS",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"WRITE SAME (10)",layout:writeSame10,operationCode:65});var writeSame16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"NDOB",length:1,"byte":1,bit:0},{name:"Obsolete",length:2,"byte":1,bit:1,obsolete:!0},{name:"UNMAP",length:1,"byte":1,bit:3},{name:"ANCHOR",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":2,bit:0},{name:"NUMBER OF LOGICAL BLOCKS",length:32,"byte":10,bit:0},{name:"GROUP NUMBER",length:5,"byte":14,bit:0},{name:"Reserved",length:3,"byte":15,bit:5,reserved:!0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"WRITE SAME (16)",layout:writeSame16,operationCode:147});var writeSame32=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"CONTROL",length:8,"byte":1,bit:0},{name:"Reserved",length:32,"byte":2,bit:0,reserved:!0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"ADDITIONAL CDB LENGTH",length:8,"byte":7,bit:0},{name:"SERVICE ACTION",length:16,"byte":8,bit:0},{name:"NDOB",length:1,"byte":10,bit:0},{name:"Obsolete",length:2,"byte":10,bit:1},{name:"UNMAP",length:1,"byte":10,bit:3},{name:"ANCHOR",length:1,"byte":10,bit:4},{name:"WRPROTECT",length:3,"byte":10,bit:5},{name:"Reserved",length:8,"byte":11,bit:0,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":12,bit:0},{name:"EXPECTED INITIAL LOGICAL BLOCK REFERENCE TAG",length:32,"byte":20,bit:0},{name:"EXPECTED LOGICAL BLOCK APPLICATION TAG",length:16,"byte":24,bit:0},{name:"LOGICAL BLOCK APPLICATION TAG MASK",length:16,"byte":26,bit:0},{name:"NUMBER OF LOGICAL BLOCKS",length:32,"byte":28,bit:0}];commands.push({name:"WRITE SAME (32)",layout:writeSame32,operationCode:127,serviceAction:13});var writeStream16=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Reserved",length:3,"byte":1,bit:0},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",
length:64,"byte":2,bit:0},{name:"STR_ID",length:16,"byte":10,bit:0},{name:"TRANSFER LENGTH",length:16,"byte":12,bit:0},{name:"GROUP NUMBER",length:6,"byte":14,bit:0},{name:"Reserved",length:2,"byte":14,bit:6},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"WRITE STREAM (16)",layout:writeStream16,operationCode:154});var writeStream32=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"CONTROL",length:8,"byte":1,bit:0},{name:"Reserved",length:16,"byte":2,bit:0,reserved:!0},{name:"STR_ID",length:16,"byte":4,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"ADDITIONAL CDB LENGTH",length:8,"byte":7,bit:0},{name:"SERVICE ACTION",length:16,"byte":8,bit:0},{name:"Reserved",length:3,"byte":10,bit:0},{name:"FUA",length:1,"byte":10,bit:3},{name:"DPO",length:1,"byte":10,bit:4},{name:"WRPROTECT",length:3,"byte":10,bit:5},{name:"Reserved",length:8,"byte":11,bit:0,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":12,bit:0},{name:"EXPECTED INITIAL LOGICAL BLOCK REFERENCE TAG",length:32,"byte":20,bit:0},{name:"EXPECTED LOGICAL BLOCK APPLICATION TAG",length:16,"byte":24,bit:0},{name:"LOGICAL BLOCK APPLICATION TAG MASK",length:16,"byte":26,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":28,bit:0}];commands.push({name:"WRITE STREAM (32)",layout:writeStream32,operationCode:127,serviceAction:16});var writeUsingToken=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"Reserved",length:3,"byte":1,bit:0},{name:"Reserved",length:32,"byte":2,bit:0},{name:"LIST IDENTIFIED",length:32,"byte":6,bit:0},{name:"PARAMETER LIST LENGTH",length:32,"byte":10,bit:0},{name:"GROUP NUMBER",length:5,"byte":14,bit:0},{name:"Reserved",length:3,"byte":15,bit:5,reserved:!0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"WRITE USING TOKEN",layout:writeUsingToken,operationCode:131,serviceAction:17});var xdwriteread10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"XORPINFO",length:1,"byte":1,bit:0},{name:"Obsolete",length:1,"byte":1,bit:1,obsolete:!0},{name:"DISABLE WRITE",length:1,"byte":1,bit:2},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"WRPROTECT",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"TRANSFER LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"XDWRITEREAD (10)",layout:xdwriteread10,operationCode:83});var xdwriteread32=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"CONTROL",length:8,"byte":1,bit:0},{name:"Reserved",length:32,"byte":2,bit:0,reserved:!0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"ADDITIONAL CDB LENGTH",length:8,"byte":7,bit:0},{name:"SERVICE ACTION",length:16,"byte":8,bit:0},{name:"XORPINFO",length:1,"byte":10,bit:0},{name:"Obsolete",length:1,"byte":10,bit:1,obsolete:!0},{name:"DISABLE WRITE",length:1,"byte":10,bit:2},{name:"FUA",length:1,"byte":10,bit:3},{name:"DPO",length:1,"byte":10,bit:4},{name:"WRPROTECT",length:3,"byte":10,bit:5},{name:"Reserved",length:8,"byte":11,bit:0,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":12,bit:0},{name:"Reserved",length:64,"byte":20,bit:0,reserved:!0},{name:"TRANSFER LENGTH",length:32,"byte":28,bit:0}];commands.push({name:"XDWRITEREAD (32)",layout:xdwriteread32,operationCode:127,serviceAction:7});var xpwrite10=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"XORPINFO",length:1,"byte":1,bit:0},{name:"Obsolete",length:1,"byte":1,bit:1,obsolete:!0},{name:"Reserved",length:1,"byte":1,bit:2,reserved:!0},{name:"FUA",length:1,"byte":1,bit:3},{name:"DPO",length:1,"byte":1,bit:4},{name:"Reserved",length:3,"byte":1,bit:5},{name:"LOGICAL BLOCK ADDRESS",length:32,"byte":2,bit:0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"TRANSFER LENGTH",length:16,"byte":7,bit:0},{name:"CONTROL",length:8,"byte":9,bit:0}];commands.push({name:"XPWRITE (10)",layout:xpwrite10,operationCode:81});var xpwrite32=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"CONTROL",length:8,"byte":1,bit:0},{name:"Reserved",length:32,"byte":2,bit:0,reserved:!0},{name:"GROUP NUMBER",length:5,"byte":6,bit:0},{name:"Reserved",length:3,"byte":6,bit:5,reserved:!0},{name:"ADDITIONAL CDB LENGTH",length:8,"byte":7,bit:0},{name:"SERVICE ACTION",length:16,"byte":8,bit:0},{name:"XORPINFO",length:1,"byte":10,bit:0},{name:"Obsolete",length:1,"byte":10,bit:1,obsolete:!0},{name:"Reserved",length:1,"byte":10,bit:2,reserved:!0},{name:"FUA",length:1,"byte":10,bit:3},{name:"DPO",length:1,"byte":10,bit:4},{name:"Reserved",length:3,"byte":10,bit:5,reserved:!0},{name:"Reserved",length:8,"byte":11,bit:0,reserved:!0},{name:"LOGICAL BLOCK ADDRESS",length:64,"byte":12,bit:0},{name:"Reserved",length:64,"byte":20,bit:0},{name:"TRANSFER LENGTH",length:32,"byte":28,bit:0}];commands.push({name:"XPWRITE (32)",layout:xpwrite32,operationCode:127,serviceAction:6});var receiveRodTokenInformation=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"SERVICE ACTION",length:5,"byte":1,bit:0},{name:"Reserved",length:3,"byte":1,bit:5,reserved:!0},{name:"LIST IDENTIFIER",length:32,"byte":2,bit:0},{name:"Reserved",length:32,"byte":6,bit:0,reserved:!0},{name:"ALLOCATION LENGTH",length:32,"byte":10,bit:0},{name:"Reserved",length:8,"byte":14,bit:0,reserved:!0},{name:"CONTROL",length:8,"byte":15,bit:0}];commands.push({name:"RECEIVE ROD TOKEN INFORMATION",layout:receiveRodTokenInformation,operationCode:132,serviceAction:7});var testUnitReady=[{name:"OPERATION CODE",length:8,"byte":0,bit:0},{name:"Reserved",length:32,"byte":1,bit:0,reserved:!0},{name:"CONTROL",length:8,"byte":5,bit:0}];commands.push({name:"TEST UNIT READY",layout:testUnitReady,operationCode:0});var cdb=[{name:"OPERATION CODE",length:8,"byte":0,bit:0}],CDB=function(){var a={};commands.forEach(function(b){var c=b.operationCode,d=b.serviceAction;if(void 0===d){var e=c.toString(16);assert.strictEqual(a[e],void 0),a[e]={name:b.name,layout:b.layout}}}),this.commandTree=a};CDB.prototype.getField=getField,CDB.prototype.decode=function(a){var b;a.length>0?(b=a.split(" "),b=b.map(function(a){return parseInt(a,16)})):b=[],console.log("CDB.prototype.decode: "+b);var c,d={name:void 0,fields:[],truncated:!1};try{c=getField(b,8,0,0);var e,f=c.toString(16);return this.commandTree[f]&&(e=this.commandTree[f]),e&&(d.name=e.name,e.layout.forEach(function(a){console.log("Extracting field "+a.name);try{var c=getField(b,a.length,a["byte"],a.bit)}catch(e){console.log("Exception: ",e)}console.log("Value: "+c.toString),d.fields.push({name:a.name,value:c.toString(16),reserved:a.reserved?!0:!1,obsolete:a.obsolete?!0:!1})})),console.log("Command: ",e),console.log("Output: ",d),d}catch(g){/Input truncated/.test(g)&&(d.truncated=!0)}return d},module.exports=CDB;