/*! scsi-cdb 2015-10-27 */
"use strict";function parseInt16(a){return parseInt(a,16)}function get_field(a,b,c,d){if(c>4)throw"byte_length too long";if(a.length>b+(c-1)){for(var e=a[b],f=b+1;b+c>f;f++)console.log("iter"),e<<=8,e+=a[f];return e&=d}throw"Data Truncated"}var parseCompareAndWrite=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"WRPROTECT",value:a[1]>>5&7}),b.push({name:"DPO",value:a[1]>>4&1}),b.push({name:"FUA",value:a[1]>>3&1}),b.push({name:"Reserved",value:a[1]>>2&1,reserved:!0}),b.push({name:"FUA_NV",value:a[1]>>1&1}),b.push({name:"Reserved",value:1&a[1],reserved:!0});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5],c=a[2]<<24|a[3]<<16|a[4]<<8|a[5];b.push({name:"LOGICAL BLOCK ADDRESS",value:[c,logicalBlockAddressLo]});var d=a[10]<<16|a[11]<<8|a[12];return b.push({name:"Reserved",value:d,reserved:!0}),b.push({name:"NUMBER OF LOGICAL BLOCKS",value:a[13]}),b.push({name:"Reserved",value:a[14]>>5&7,reserved:!0}),b.push({name:"GROUP NUMBER",value:31&encodedCDb[14]}),b.push({name:"CONTROL",value:a[15]}),b},parseFormatUnit=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"FMTPINFO",value:a[1]>>6&3}),b.push({name:"LONGLIST",value:a[1]>>5&1}),b.push({name:"FMTDATA",value:a[1]>>4&1}),b.push({name:"CMPLIST",value:a[1]>>3&1}),b.push({name:"DEFECT LIST FORMAT",value:7&a[1]}),b.push({name:"Vendor specific",value:a[2]});var c=a[3]<<8|a[4];return b.push({name:"Obsolete",value:c,obsolete:!0}),b.push({name:"CONTROL",value:a[5]}),b},parseGetLbaStatus=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1]>>5&7,reserved:!0}),b.push({name:"SERVICE ACTION",value:31&a[1]});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5],d=a[6]<<24|a[7]<<16|a[8]<<8|a[9];b.push({name:"STARTING LOGICAL BLOCK ADDRESS",value:[c,d]});var e=a[10]<<24|a[11]<<16|a[12]<<8|a[13];return b.push({name:"ALLOCATION LENGTH",value:e}),b.push({name:"Reserved",value:a[14],reserved:!0}),b.push({name:"CONTROL",value:a[15]}),b},parseOrwrite16=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"ORPROTECT",value:a[1]>>5&7}),b.push({name:"DPO",value:a[1]>>4&1}),b.push({name:"FUA",value:a[1]>>3&1}),b.push({name:"Reserved",value:a[1]>>2&1,reserved:!0}),b.push({name:"FUA_NV",value:a[1]>>1&1}),b.push({name:"Reserved",value:1&a[1],reserved:!0});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5],d=a[6]<<24|a[7]<<16|a[8]<<8|a[9];b.push({name:"STARTING LOGICAL BLOCK ADDRESS",value:[c,d]});var e=a[2]<<24|a[3]<<16|a[4]<<8|a[5];return b.push({name:"TRANSFER LENGTH",value:e}),b.push({name:"Reserved",value:a[14]>>5&7,reserved:!0}),b.push({name:"GROUP NUMBER",value:31&encodedCDb[14]}),b.push({name:"CONTROL",value:a[15]}),b},parseOrwrite32=function(a){fields.push({name:"OPERATION CODE",value:a[0]}),fields.push({name:"CONTROL",value:a[1]}),fields.push({name:"Reserved",value:a[2]>>3&31,reserved:!0}),fields.push({name:"BMOP",value:7&a[2]}),fields.push({name:"Reserved",value:a[3]>>4&15,reserved:!0}),fields.push({name:"PREVIOUS GENERATION PROCESSING",value:15&a[3]}),fields.push({name:"Reserved",value:a[4]<<8|a[5],reserved:!0}),fields.push({name:"Reserved",value:a[6]>>5&7,reserved:!0}),fields.push({name:"GROUP NUMBER",value:31&encodedCDb[6]}),fields.push({name:"ADDITIONAL CDB LENGTH",value:a[7]});var b=a[8]<<8|a[9];fields.push({name:"SERVICE ACTION",value:b}),fields.push({name:"ORPROTECT",value:a[10]>>5&7}),fields.push({name:"DPO",value:a[10]>>4&1}),fields.push({name:"FUA",value:a[10]>>3&1}),fields.push({name:"Reserved",value:a[10]>>2&1,reserved:!0}),fields.push({name:"FUA_NV",value:a[10]>>1&1}),fields.push({name:"Reserved",value:1&a[10],reserved:!0}),fields.push({name:"Reserved",value:a[11]});var c=a[12]<<24|a[13]<<16|a[14]<<8|a[15],d=a[16]<<24|a[17]<<16|a[18]<<8|a[19];fields.push({name:"LOGICAL BLOCK ADDRESS",value:[c,d]});var e=a[20]<<24|a[21]<<16|a[22]<<8|a[23];fields.push({name:"EXPECTED ORWGENERATION",value:e});var f=a[24]<<24|a[25]<<16|a[26]<<8|a[27];fields.push({name:"NEW ORWGENERATION",value:f});var g=a[28]<<24|a[29]<<16|a[30]<<8|a[31];return fields.push({name:"TRANSFER LENGTH",value:g}),fields},parsePopulateToken=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1]>>5&7,reserved:!0}),b.push({name:"SERVICE ACTION",value:31&a[1]});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5];b.push({name:"Reserved",value:c,reserved:!0});a[6]<<24|a[7]<<16|a[8]<<8|a[9];b.push({name:"LIST IDENTIFIER",value:listIdentified});var d=a[10]<<24|a[11]<<16|a[12]<<8|a[13];return b.push({name:"PARAMETER LIST LENGTH",value:d}),b.push({name:"Reserved",value:a[14]>>5&7,reserved:!0}),b.push({name:"GROUP NUMBER",value:31&a[14]}),b.push({name:"CONTROL",value:a[15]}),b},parsePreFetch10=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1]>>2&63,reserved:!0}),b.push({name:"IMMED",value:a[1]>>1&1}),b.push({name:"Obsolete",value:1&a[1],obsolete:!0});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5];return b.push({name:"LOGICAL BLOCK ADDRESS",value:c}),b.push({name:"Reserved",value:a[6]>>5&7,reserved:!0}),b.push({name:"GROUP NUMBER",value:31&a[6]}),b.push({name:"PREFETCH LENGTH",value:a[7]<<8|a[8]}),b.push({name:"CONTROL",value:a[9]}),b},parsePreFetch16=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1]>>2&63,reserved:!0}),b.push({name:"IMMED",value:a[1]>>1&1}),b.push({name:"Obsolete",value:1&a[1],obsolete:!0});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5],d=a[6]<<24|a[7]<<16|a[8]<<8|a[9];b.push({name:"LOGICAL BLOCK ADDRESS",value:[c,d]});var e=a[10]<<24|a[11]<<16|a[12]<<8|a[13];return b.push({name:"PREFETCH LENGTH",value:e}),b.push({name:"Reserved",value:a[14]>>5&7,reserved:!0}),b.push({name:"GROUP NUMBER",value:31&a[14]}),b.push({name:"CONTROL",value:a[15]}),b},parsePreventAllowMediumRemoval=function(a){var b=[];return b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1],reserved:!0}),b.push({name:"Reserved",value:a[2],reserved:!0}),b.push({name:"Reserved",value:a[3],reserved:!0}),b.push({name:"Reserved",value:a[4]>>2&63,reserved:!0}),b.push({name:"PREVENT",value:3&a[4]}),b.push({name:"CONTROL",value:a[5]}),b},parseRead10=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"RDPROTECT",value:a[1]>>5&7}),b.push({name:"DPO",value:a[1]>>4&1}),b.push({name:"FUA",value:a[1]>>3&1}),b.push({name:"RARC",value:a[1]>>2&1}),b.push({name:"FUA_NV",value:a[1]>>1&1}),b.push({name:"Obsolete",value:1&a[1],obsolete:!0});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5];b.push({name:"LOGICAL BLOCK ADDRESS",value:c}),b.push({name:"Reserved",value:a[6]>>5&7,reserved:!0}),b.push({name:"GROUP NUMBER",value:31&a[6]});var d=a[7]<<8|a[8];return b.push({name:"TRANSFER LENGTH",value:d}),b.push({name:"CONTROL",value:a[8]}),b},parseRead12=function(a){var b=[];b.push({name:"Operation Code",value:a[0]}),b.push({name:"RDPROTECT",value:a[1]>>5&7}),b.push({name:"DPO",value:a[1]>>4&1}),b.push({name:"FUA",value:a[1]>>3&1}),b.push({name:"RARC",value:a[1]>>2&1}),b.push({name:"FUA_NV",value:a[1]>>1&1}),b.push({name:"Obsolete",value:1&a[1],obsolete:!0});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5];b.push({name:"LOGICAL BLOCK ADDRESS",value:c});var d=a[6]<<24|a[7]<<16|a[8]<<8|a[9];return b.push({name:"TRANSFER LENGTH",value:d}),b.push({name:"Restricted for MMC-6",value:a[10]>>7&1}),b.push({name:"Reserved",value:a[10]>>5&3,reserved:!0}),b.push({name:"GROUP NUMBER",value:31&a[10]}),b.push({name:"CONTROL",value:a[11]}),b},parseRead16=function(a){var b=[];b.push({name:"Operation Code",value:a[0]}),b.push({name:"RDPROTECT",value:a[1]>>5&7}),b.push({name:"DPO",value:a[1]>>4&1}),b.push({name:"FUA",value:a[1]>>3&1}),b.push({name:"RARC",value:a[1]>>2&1}),b.push({name:"FUA_NV",value:a[1]>>1&1}),b.push({name:"Obsolete",value:1&a[1],obsolete:!0});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5],d=a[6]<<24|a[7]<<16|a[8]<<8|a[9];b.push({name:"LOGICAL BLOCK ADDRESS",value:[c,d]});var e=a[10]<<24|a[11]<<16|a[12]<<8|a[13];return b.push({name:"TRANSFER LENGTH",value:e}),b.push({name:"Restricted for MMC-6",value:a[14]>>7&1}),b.push({name:"Reserved",value:a[14]>>5&3,reserved:!0}),b.push({name:"GROUP NUMBER",value:31&a[14]}),b.push({name:"CONTROL",value:a[15]}),b},parseRead32=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"CONTROL",value:a[1]});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5];b.push({name:"Reserved",value:c,reserved:!0}),b.push({name:"Reserved",value:a[6]>>5&7,reserved:!0}),b.push({name:"GROUP NUMBER",value:31&a[6]}),b.push({name:"ADDITIONAL CDB LENGTH",value:a[7]});var d=a[8]<<8|a[9];b.push({name:"SERVICE ACTION",value:d}),b.push({name:"RDPROTECT",value:a[10]>>5&7}),b.push({name:"DPO",value:a[10]>>4&1}),b.push({name:"FUA",value:a[10]>>3&1}),b.push({name:"RARC",value:a[10]>>2&1}),b.push({name:"FUA_NV",value:a[10]>>1&1}),b.push({name:"Reserved",value:1&a[10],reserved:!0}),b.push({name:"Reserved",value:a[11],reserved:!0});var e=a[12]<<24|a[13]<<16|a[14]<<8|a[15],f=a[16]<<24|a[17]<<16|a[18]<<8|a[19];b.push({name:"LOGICAL BLOCK ADDRESS",value:[e,f]});var g=a[20]<<24|a[21]<<16|a[22]<<8|a[23];b.push({name:"EXPECTED INITIAL LOGICAL BLOCK REFERENCE TAG",value:g});var h=a[24]<<8|a[25];b.push({name:"EXPECTED LOGICAL BLOCK APPLICATION TAG",value:h});var i=a[27]<<8|a[28];b.push({name:"LOGICAL BLOCK APPLICATION TAG MASK",value:i});var j=a[28]<<24|a[29]<<16|a[30]<<8|a[31];return b.push({name:"TRANSFER LENGTH",value:j}),b},parseReadCapacity10=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1]>>1&127,reserved:!0}),b.push({name:"Obsolete",value:1&a[1],obsolete:!0});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5];b.push({name:"Obsolete",value:c,obsolete:!0});var d=a[6]<<8|a[7];return b.push({name:"Reserved",value:d,reserved:!0}),b.push({name:"Reserved",value:a[8]>>1&127,reserved:!0}),b.push({name:"Obsolete",value:1&a[8],obsolete:!0}),b.push({name:"CONTROL",value:a[9]}),b},parseReadCapacity16=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1]>>5&7,reserved:!0}),b.push({name:"SERVICE ACTION",value:31&a[1]});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5],d=a[6]<<24|a[7]<<16|a[8]<<8|a[9];b.push({name:"Obsolete",value:[c,d],obsolete:!0});var e=a[10]<<24|a[11]<<16|a[12]<<8|a[13];return b.push({name:"ALLOCATION LENGTH",value:e}),b.push({name:"Reserved",value:a[14]>>1&127,reserved:!0}),b.push({name:"Obsolete",value:1&a[14],obsolete:!0}),b.push({name:"CONTROL",value:a[15]}),b},parseReadDefectData10=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1],reserved:!0}),b.push({name:"Reserved",value:a[2]>>5&7,reserved:!0}),b.push({name:"REQ_PLIST",value:a[2]>>4&1}),b.push({name:"REQ_GLIST",value:enodedCdb[2]>>3&1}),b.push({name:"DEFECT LIST_FORMAT",value:7&a[2]});var c=a[3]<<24|a[4]<<16|a[5]<<8|a[5];return b.push({name:"Reserved",value:c,reserved:!0}),b.push({name:"ALLOCATION LENGTH",value:a[7]<<8|a[8]}),b.push({name:"CONTROL",value:a[9]}),b},parseReadDefectData12=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[2]>>5&7,reserved:!0}),b.push({name:"REQ_PLIST",value:a[2]>>4&1}),b.push({name:"REQ_GLIST",value:enodedCdb[2]>>3&1}),b.push({name:"DEFECT LIST FORMAT",value:7&a[2]});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5];b.push({name:"ADDRESS DESCRIPTOR INDEX",value:c});var d=a[6]<<24|a[7]<<16|a[8]<<8|a[9];return b.push({name:"ALLOCATION LENGTH",value:d}),b.push({name:"Reserved",value:a[10],reserved:!0}),b.push({name:"CONTROL",value:a[11]}),b},parseReadLong10=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1]>>3&31,reserved:!0}),b.push({name:"PBLOCK",value:a[1]>>2&1}),b.push({name:"CORRCT",value:a[1]>>1&1}),b.push({name:"Obsolete",value:1&a[1],obsolete:!0});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5];return b.push({name:"LOGICAL BLOCK ADDRESS",value:c}),b.push({name:"Reserved",value:a[6],reserved:!0}),b.push({name:"BYTE TRANSFER LENGTH",value:a[7]<<8|a[8]}),b.push({name:"CONTROL",value:a[9]}),b},parseReadLong16=function(a){var b=[];b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1]>>5&7,reserved:!0}),b.push({name:"SERVICE ACTION",value:31&a[1]});var c=a[2]<<24|a[3]<<16|a[4]<<8|a[5],d=a[6]<<24|a[7]<<16|a[8]<<8|a[9];return b.push({name:"LOGICAL BLOCK ADDRESS",value:[c,d]}),b.push({name:"Reserved",value:a[10]<<8|a[11],reserved:!0}),b.push({name:"BYTE TRANSFER LENGTH",value:a[13]<<8|a[13]}),b.push({name:"Reserved",value:a[14]>>1&63,reserved:!0}),b.push({name:"PBLOCK",value:a[14]>>1&1}),b.push({name:"CORRCT",value:1&a[14]}),b.push({name:"CONTROL",value:a[15]}),b},parseReassignBlocks=function(a){var b=[];return b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1]>>2&63,reserved:!0}),b.push({name:"LONGLBA",value:a[1]>>1&1}),b.push({name:"LONGLIST",value:1&a[1]}),b.push({name:"Reserved",value:a[2]<<16|a[3]<<8|a[4],reserved:!0}),b.push({name:"CONTROL",value:a[5]}),b},parseReceiveRodTokenInformation=function(a){var b=[];return b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1]>>5&7,reserved:!0}),b.push({name:"SERVICE ACTION",value:31&a[1]}),b},parseTestUnitReady=function(a){var b=[];return b.push({name:"OPERATION CODE",value:a[0]}),b.push({name:"Reserved",value:a[1]<<24|a[2]<<16|a[3]<<8|a[4],reserved:!0}),b.push({name:"CONTROL",value:a[5]}),b},scsi_commands=[{name:"ACCESS CONTROL IN",opcode:134,length:16},{name:"ACCESS CONTROL OUT",opcode:135,length:16},{name:"ATA PASS-THROUGH",opcode:161,length:12},{name:"ATA PASS-THROUGH",opcode:133,length:16},{name:"CHANGE ALIASES",opcode:164,service_action:11,length:12},{name:"COMPARE AND WRITE",opcode:137,length:16,parser:parseCompareAndWrite},{name:"FORMAT UNIT",opcode:4,length:[4,7],parser:parseFormatUnit},{name:"GET LBA STATUS",opcode:158,service_action:18,length:16,parser:parseGetLbaStatus},{name:"INQUIRY",opcode:18,length:6,parser:void 0},{name:"LOG SELECT",opcode:76,length:10,parser:void 0},{name:"LOG SENSE",opcode:77,length:10,parser:void 0},{name:"MAINTENANCE IN",opcode:163,service_action:[[0,4],[6,9]],length:12,parser:void 0},{name:"MAINTENANCE OUT",opcode:164,service_action:[[0,5],[7,9]],length:12,parser:void 0},{name:"MODE SELECT (6)",opcode:21,length:6,parser:void 0},{name:"MODE SELECT (10)",opcode:85,length:10,parser:void 0},{name:"MODE SENSE (6)",opcode:26,length:6,parser:void 0},{name:"MODE SENSE (10)",opcode:90,length:10,parser:void 0},{name:"ORWRITE (16)",opcode:139,length:16,parser:parseOrwrite16},{name:"ORWRITE (32)",opcode:127,service_action:14,length:32,parser:parseOrwrite32},{name:"PERSISTENT RESERVE IN",opcode:94,length:10,parser:void 0},{name:"PERSISTENT RESERVE OUT",opcode:15,length:10,parser:void 0},{name:"POPULATE TOKEN",opcode:131,service_action:16,length:16,parser:parsePopulateToken},{name:"PRE-FETCH (10)",opcode:52,length:10,parser:parsePreFetch10},{name:"PRE-FETCH (16)",opcode:144,length:16,parser:parsePreFetch16},{name:"PREVENT ALLOW REMOVE MEDIUM",opcode:30,length:void 0,parser:parsePreventAllowMediumRemoval},{name:"READ (10)",opcode:40,length:10,parser:parseRead10},{name:"READ (12)",opcode:168,length:12,parser:parseRead12},{name:"READ (16)",opcode:136,length:16,parser:parseRead16},{name:"READ (32)",opcode:127,service_action:9,length:32,parser:parseRead32},{name:"READ ATTRIBUTE",opcode:140,length:16,parser:void 0},{name:"READ BUFFER",opcode:60,length:10,parser:void 0},{name:"READ CAPACITY (10)",opcode:37,length:10,parser:parseReadCapacity10},{name:"READ CAPACITY (16)",opcode:158,service_action:16,length:16,parser:parseReadCapacity16},{name:"READ DEFECT DATA (10)",opcode:55,length:10,parser:parseReadDefectData10},{name:"READ DEFECT DATA (12)",opcode:183,length:12,parser:parseReadDefectData12},{name:"READ LONG (10)",opcode:62,length:10,parser:parseReadLong10},{name:"READ LONG (16)",opcode:158,service_action:17,length:16,parser:parseReadLong16},{name:"REASSIGN BLOCKS",opcode:7,length:6,parser:void 0},{name:"RECEIVE COPY DATA(LID4)",opcode:132,service_action:6,length:16,parser:void 0},{name:"RECEIVE COPY DATA(LID3)",opcode:132,service_action:1,length:16,parser:void 0},{name:"RECEIVE DIAGNOSTIC RESULTS",opcode:28,length:6,parser:void 0},{name:"RECEIVE ROD TOKEN INFORMATION",opcode:132,service_action:7,length:16,parser:parseReceiveRodTokenInformation},{name:"REDUNDANCY GROUP IN",opcode:186,length:void 0,parser:void 0},{name:"REDUNDANCY GROUP OUT",opcode:187,length:void 0,parser:void 0},{name:"REPORT REFERRALS",opcode:158,service_action:19,length:16,parser:void 0},{name:"REPORT ALIASES",opcode:163,service_action:11,length:12,parser:void 0},{name:"REPORT IDENTIFYING INFORMATION",opcode:163,service_action:5,length:12,parser:void 0},{name:"REPORT LUNS",opcode:160,length:12,parser:void 0},{name:"REPORT PRIORITY",opcode:163,service_action:14,length:12,parser:void 0},{name:"REPORT SUPPORTED OPERATION CODES",opcode:163,service_action:12,length:12,parser:void 0},{name:"REPORT SUPPORTED TASK MANAGEMENT FUNCTIONS",opcode:163,service_action:13,length:12,parser:void 0},{name:"REPORT TARGET PORT GROUPS",opcode:163,service_action:10,length:12,parser:void 0},{name:"REQUEST SENSE",opcode:3,length:6,parser:void 0},{name:"SANITIZE",opcode:72,length:10,parser:void 0},{name:"SECURITY PROTOCOL IN",opcode:162,length:12,parser:void 0},{name:"SECURITY PROTOCOL OUT",opcode:181,length:12,parser:void 0},{name:"SEND DIAGNOSTIC",opcode:29,length:6,parser:void 0},{name:"SET IDENTIFYING INFORMATION",opcode:164,service_action:6,length:12,parser:void 0},{name:"SET PRIORITY",opcode:164,service_action:14,length:12,parser:void 0},{name:"SET TARGET PORT GROUPS",opcode:164,service_action:10,length:12,parser:void 0},{name:"SPARE IN",opcode:188,length:void 0,parser:void 0},{name:"SPARE OUT",opcode:189,length:void 0,parser:void 0},{name:"START STOP UNIT",opcode:27,length:6,parser:void 0},{name:"SYNCHRONIZE CACHE (10)",opcode:53,length:10,parser:void 0},{name:"SYNCHRONIZE CACHE (16)",opcode:145,length:10,parser:void 0},{name:"TEST UNIT READY",opcode:0,length:6,parser:parseTestUnitReady},{name:"VERIFY (10)",opcode:47,length:10,parser:void 0},{name:"VERIFY (12)",opcode:175,length:12,parser:void 0},{name:"VERIFY (16)",opcode:143,length:16,parser:void 0}],service_action_info=[{opcode:134,byte_offset:1,byte_length:1,bitmask:31},{opcode:164,byte_offset:void 0,byte_length:void 0,bitmask:void 0},{opcode:158,byte_offset:1,byte_length:1,bitmask:31},{opcode:163,byte_offset:void 0,byte_length:void 0,bitmask:void 0},{opcode:164,byte_offset:void 0,byte_length:void 0,bitmask:void 0},{opcode:127,byte_offset:8,byte_length:2,bitmask:65535},{opcode:131,byte_offset:1,byte_length:1,bitmask:31},{opcode:158,byte_offset:1,byte_length:1,bitmask:31},{opcode:132,byte_offset:1,byte_length:1,bitmask:31}],CDB=function(){};CDB.prototype.decode=function(a){if(0==a.length)return{truncated:!0};var b=a.split(" ");console.log("Input Array: "+b),b=b.map(function(a){return parseInt(a,16)}),console.log("Input Array: "+b);for(var c,d=b[0],e=0;e<service_action_info.length;e++)if(service_action_info[e].opcode==d){c=get_field(b,service_action_info[e].byte_offset,service_action_info[e].byte_length,service_action_info[e].bitmask);break}for(var f,g,e=0;e<scsi_commands.length;e++)if(scsi_commands[e].opcode==d&&scsi_commands[e].service_action==c){f=scsi_commands[e].name,g=scsi_commands[e].length;break}console.log("Name: "+f),console.log("Length: "+g);var h={name:f,fields:scsi_commands[e].parser(b),truncated:!1};return h},CDB.prototype.parse=function(a){if(console.log("Parsing encoded CDB: "+a),!Array.isArray(a))throw"Invalid encodedCdb, must be an array";if(a.length>0){for(var b,c=a[0],d=0;d<service_action_info.length;d++)if(service_action_info[d].opcode==c){b=get_field(a,service_action_info[d].byte_offset,service_action_info[d].byte_length,service_action_info[d].bitmask);break}for(var e,f,d=0;d<scsi_commands.length;d++)if(scsi_commands[d].opcode==c&&scsi_commands[d].service_action==b){e=scsi_commands[d].name,f=scsi_commands[d].length;break}this.name=e,this.fields=scsi_commands[d].parser(a)}},"undefined"==typeof module||(module.exports=CDB);